#!/bin/sh
#
# Pathetic configure script for mfd
#
# NB: It doesn't do any dependencies checking
#
#

# default parameters

zeroconfig="yes"
audio="yes"
daapserver="yes"

for opt do
  case "$opt" in
  --enable-zeroconfig) zeroconfig="yes"
  ;;
  --disable-zeroconfig) zeroconfig="no"
  ;;
  --enable-audio) audio="yes"
  ;;
  --disable-audio) audio="no"
  ;;
  --enable-daapserver) daapserver="yes"
  ;;
  --disable-daapsever) daapserver="no"
  ;;
  --enable-all)
      zeroconfig="yes"
      audio="yes"
      daapserver="yes"
  ;;
  --disable-all)
      zeroconfig="no"
      audio="no"
      daapserver="no"
  ;;
  esac
done

if test x"$1" = x"-h" -o x"$1" = x"--help" ; then
cat << EOF

Usage: configure [options]
Options: [defaults in brackets after descriptions]

Standard options:
  --help               print this message
  --enable-zeroconfig  enable auto discovery of mfd services [default=yes]
  --enable-audio       enable audio playing                  [default=yes]
  --enable-daapserver  enable serving audio via daap         [default=yes]

All options can be turned off with --disable-foo


EOF
exit 1
fi

echo "Creating config.pro"

echo ""
echo "Configuration settings: "
echo " "

echo "#" > ./config.pro
echo "#    Automatically generated by configure - modify only under penalty of death" >> ./config.pro
echo "#" >> ./config.pro
echo " " >> ./config.pro
echo "#    The dummy plugin is always built " >> ./config.pro
echo " " >> ./config.pro
echo "SUBDIRS += ./mfd/plugins/dummy " >> ./config.pro
echo " " >> ./config.pro

#
#   Dummy
#

    echo "                      dummy support: yes (always)"


#
#   Zero config
#

if test "$zeroconfig" = "yes" ; then
    echo "                 zeroconfig support: yes"        
    echo "#    Build the zeroconfig plugin " >> ./config.pro
    echo " " >> ./config.pro
    echo "SUBDIRS += ./mfd/plugins/zeroconfig " >> ./config.pro
    echo " " >> ./config.pro
fi

if test "$zeroconfig" = "no" ; then
    echo "                 zeroconfig support: no"
fi

#
#   audio
#

if test "$audio" = "yes" ; then
    echo "                      audio support: yes"

    #
    #   Conditional build and link stuff for audio
    #

    echo "SUBDIRS += ./mfd/plugins/audio "   >> ./config.pro

fi

if test "$audio" = "no" ; then
    echo "                      audio support: no"
fi

#
#   daapserver
#

if test "$daapserver" = "yes" ; then
    echo "                daap server support: yes"

    #
    #   Conditional build and link stuff for daap server
    #

    echo "SUBDIRS += ./mfd/plugins/daapserver "   >> ./config.pro

fi

if test "$daapserver" = "no" ; then
    echo "                daap server support: no"
fi




echo ""

