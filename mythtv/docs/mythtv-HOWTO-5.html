<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
 <META NAME="GENERATOR" CONTENT="LinuxDoc-Tools 0.9.21">
 <TITLE>Installing and using MythTV: Downloading and compiling.</TITLE>
 <LINK HREF="mythtv-HOWTO-6.html" REL=next>
 <LINK HREF="mythtv-HOWTO-4.html" REL=previous>
 <LINK HREF="mythtv-HOWTO.html#toc5" REL=contents>
</HEAD>
<BODY>
<A HREF="mythtv-HOWTO-6.html">Next</A>
<A HREF="mythtv-HOWTO-4.html">Previous</A>
<A HREF="mythtv-HOWTO.html#toc5">Contents</A>
<HR>
<H2><A NAME="s5">5.</A> <A HREF="mythtv-HOWTO.html#toc5">Downloading and compiling.</A></H2>

<P>Get MythTV from the 
<A HREF="http://www.mythtv.org">mythtv.org</A>
web site.  There are two installation methods you may choose from.  The
first is to download the latest release in tarball format and compile.  The
tarball release of MythTV should work on a wide variety of systems and
should be the preferred method for new users.  If you wish to use the CVS
version of MythTV you may obtain it from CVS this way:
<A NAME="cvs"></A> 
<BLOCKQUOTE><CODE>
<PRE>
$ mkdir mythtv
$ cd mythtv
$ cvs -d :pserver:mythtv@cvs.mythtv.org:/var/lib/mythcvs login
Logging in to :pserver:mythtv@cvs.mythtv.org:/var/lib/mythcvs
CVS password: mythtv
$ cvs -z3 -d :pserver:mythtv@cvs.mythtv.org:/var/lib/mythcvs checkout mythtv
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>
<FIGURE>
<EPS FILE="warning.eps">
<IMG SRC="warning.png">
<CAPTION><B>NOTE</B>:  You may get an error about cvs not finding a
<CODE>.cvspass</CODE> file the very first time you run it.  This is normal.</CAPTION>
</FIGURE>

The other MythTV modules may be downloaded from CVS the same way; replace
"mythtv" with "mythweather", "mythgallery", "mythmusic", etc.</P>
<P>If you wish to stay up-to-date with CVS, you may replace "checkout mythtv"
with <CODE>update mythtv</CODE> after you've done your initial download.</P>
<P>
<FIGURE>
<EPS FILE="stop.eps">
<IMG SRC="stop.png">
<CAPTION><B>NOTE</B>: If you are going to use CVS to compile MythTV rather than
using the distribution tarball, it is <B>strongly</B> recommended that you
join the 
<A HREF="http://www.mythtv.org/mailman/listinfo/mythtv-commits/">http://www.mythtv.org/mailman/listinfo/mythtv-commits/</A> and 
<A HREF="http://www.mythtv.org/mailman/listinfo/mythtv-dev/">http://www.mythtv.org/mailman/listinfo/mythtv-dev/</A> mailing lists.</CAPTION>
</FIGURE>
</P>
<P>If you are in North America you will use the DataDirect
grabber which is built-in to MythTV.  You <EM>do not</EM> need to install
XMLTV, but you need <B>wget</B> version 1.9.1 or higher.</P>
<P>Get XMLTV from 
<A HREF="http://xmltv.sourceforge.net">http://xmltv.sourceforge.net</A>.  Download the latest version (0.5.34).</P>
<P>
<HR>
<PRE>
NOTE for Mandrake users:  If you have added a "PLF" mirror, you may skip the
next step and type:

# urpmi libmp3lame0 libmp3lame0-devel

NOTE for Red Hat users: If you are installing with apt or yum, you may skip
this step, it will be taken care of. Otherwise get lame and lame-devel from
&lt;url url="http://ATrpms.net/name/lame/" name="http://ATrpms.net/name/lame/">.

After downloading, be sure to install both:
# rpm -Uvh lame*
</PRE>
<HR>
</P>
<P>Get lame from 
<A HREF="http://www.mp3dev.org/mp3">http://www.mp3dev.org/mp3</A>.  Download the source code to v3.93.1 by
following the links to sourceforge.net</P>

<H2><A NAME="nonintelcpu_"></A> <A NAME="ss5.1">5.1</A> <A HREF="mythtv-HOWTO.html#toc5.1">Notes on compiling on a system with non-Intel processors. </A>
</H2>

<P>If you've got a system with an AMD K6-2 or a VIA C3 processor, make the
following change in the <CODE>settings.pro</CODE> file.</P>
<P>Look for 
<PRE>
-march=pentiumpro
</PRE>
 
and replace it with
<PRE>
-march=i586
</PRE>
 
before you compile.</P>
<P>Recent AMD processors, like the Duron, Thunderbird and Athlon don't need this
change.</P>

<H2><A NAME="ss5.2">5.2</A> <A HREF="mythtv-HOWTO.html#toc5.2">Building LAME.</A>
</H2>

<P>Open a shell and switch to the directory where you saved lame.
<BLOCKQUOTE><CODE>
<PRE>
$ tar -xzf lame-3.93.1.tar.gz
$ cd lame-3.93.1
$ ./configure
$ make
$ make test
$ su
# make install
</PRE>
</CODE></BLOCKQUOTE>

Check that it worked:
<BLOCKQUOTE><CODE>
<PRE>
# ls -l /usr/local/lib
-rw-r--r--    1 root     root       381706 Nov  4 14:22 libmp3lame.a
-rwxr-xr-x    1 root     root          674 Nov  4 14:22 libmp3lame.la*
lrwxrwxrwx    1 root     root           19 Nov  4 14:22 libmp3lame.so ->
libmp3lame.so.0.0.0*
lrwxrwxrwx    1 root     root           19 Nov  4 14:22 libmp3lame.so.0 ->
libmp3lame.so.0.0.0*
-rwxr-xr-x    1 root     root       360197 Nov  4 14:22
libmp3lame.so.0.0.0*

# exit
$ 
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H2><A NAME="ss5.3">5.3</A> <A HREF="mythtv-HOWTO.html#toc5.3">XMLTV. </A>
</H2>

<H3>Red Hat Linux and Fedora Core:</H3>

<P>RPMs for <B>XMLTV</B> and all of its dependencies can be obtained from
<A HREF="http://ATrpms.net/name/xmltv/">http://ATrpms.net/name/xmltv/</A>. The web page has a
list of all the dependent packages you must download and install.
<BLOCKQUOTE><CODE>
<PRE>
# rpm -Uvh xmltv* perl*
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>If you install from this location you may skip to 
<A HREF="#manually_building_mythtv">Manually building MythTV</A>.</P>
<H3>Mandrake</H3>

<P>RPMs for <B>XMLTV</B> and all of its dependencies are located in
Mandrake's "contrib".  If you have added a contrib mirror, try installing
<B>XMLTV</B>:
<BLOCKQUOTE><CODE>
<PRE>
# urpmi xmltv xmltv-grabbers
</PRE>
</CODE></BLOCKQUOTE>

If this does not work, it is possible that contrib for your Mandrake version
does not have <B>XMLTV</B>, so you may install the XMLTV prerequisites by typing:
<BLOCKQUOTE><CODE>
<PRE>
# urpmi perl-xml-twig perl-xml-writer perl-datemanip perl-libwww-perl
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>and skip straight to the XMLTV compilation step.</P>

<H3>Other distributions and manual installation.</H3>

<P>Continuing on:</P>
<P>
<A NAME="untarring_xmltv"></A> Untar the xmltv file:
<BLOCKQUOTE><CODE>
<PRE>
$ tar -xjf xmltv-0.5.34.tar.bz2
</PRE>
</CODE></BLOCKQUOTE>

Install the xmltv prerequisites:</P>
<P>
<BLOCKQUOTE><CODE>
<PRE>
$ su
# perl -MCPAN -e shell
cpan> install XML::Twig
cpan> install Date::Manip
Date::Manip is up to date.
cpan> install LWP
cpan> install XML::Writer
cpan> exit
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Change to the XMLTV directory and compile it:
<BLOCKQUOTE><CODE>
<PRE>
$ cd xmltv-0.5.34
$ perl Makefile.PL
</PRE>
</CODE></BLOCKQUOTE>

You can answer "N" to the tv_check, tv_pick_cgi questions.  Say "yes" to
the grabber required for your location.</P>
<P>You may get errors about modules not being installed.  They shouldn't matter
if you're installing North America and have followed the instructions to
this point.
<BLOCKQUOTE><CODE>
<PRE>
$ make
$ make test
$ su
# make install
# exit
</PRE>
</CODE></BLOCKQUOTE>
</P>

<H2><A NAME="ConfigureDD"></A> <A NAME="ss5.4">5.4</A> <A HREF="mythtv-HOWTO.html#toc5.4">Configuring the Zap2It.com DataDirect service. </A>
</H2>

<H3>Introduction.</H3>

<P>Zap2It DataDirect is a service provided by Zap2It, a subsidiary of
Tribune Media Services.  TMS is one of the primary providers for program
listing data in the United States and Canada.  There are a number of
advantages to using DataDirect rather than the standard XMLTV
<CODE>tv_grab_na</CODE> grabber.</P>
<P>
<UL>
<LI>The <CODE>tv_grab_na</CODE> grabber is no longer supported and will not be
fixed when problems occur.</LI>
<LI>It's much faster, because the grabber isn't downloading hundreds of
HTML pages and trying to parse the program data out of the HTML.</LI>
<LI>It contains more program information.</LI>
<LI>It's easier on the Zap2It servers, since they're not generating
hundreds of custom HTML pages when you scrape their listings.</LI>
<LI>The service is available free of charge by periodically filling in
surveys similar to the one presented during registration, and the data
provider has no intention of charging for it in the future.</LI>
</UL>
</P>
<P>If you wish to use Zap2It DataDirect, you'll need to establish a user
account.  Go to 
<A HREF="http://labs.zap2it.com">http://labs.zap2it.com</A> and click on the "New User? Sign Up" link. 
Read the license terms, and if you agree with them click "Accept".  The next
screen is the subscription registration.  In the "Certificate Code" field,
enter <B>ZIYN-DQZO-SBUT</B>.</P>
<P>Fill in the survey, then proceed to the lineup choices and configure your
account for your particular location and the channels that you have.  This
configuration will be imported into MythTV when you first run the
<B>setup</B> program.</P>
<P>See the section called 
<A HREF="mythtv-HOWTO-21.html#MigratingtoDD">Migrating from XMLTV to DataDirect</A> for instructions on moving to to DataDirect if you are
currently using XMLTV.  If you are starting from a fresh installation, the
simplest thing is to immediately start using DataDirect.</P>

<H3>Grabbing channel icons for DataDirect users.</H3>

<P>While the DataDirect TV listings service has several advantages, it does
not support grabbing logo icons for the stations you receive. However, there
are utilities provided that you can use to grab your initial set of icons
and to update them if your lineups change.</P>
<P>First, you need to generate or obtain an XML file with the information for
your stations.</P>
<P>If you have XMLTV software installed, there is a perl script in MythTV's
<CODE>contrib/</CODE> directory which will generate this file for you. Run the
command:
<BLOCKQUOTE><CODE>
<PRE>
$ perl mkiconmap.pl
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>You will be asked for your zipcode and the service that you use. If there
are no errors, the <CODE>iconmap.xml</CODE> file that you need for the next step
will be created.</P>
<P>If you do not have XMLTV software installed and do not want to install it
for the sake of this minor task, there is a generic
<CODE>contrib/master_iconmap.xml</CODE> which you can copy and use but this may
not be as complete as using the specific information for your service.</P>
<P>Once you have an <CODE>iconmap.xml</CODE> file, add the icon information to your
database and grab any new icons with the command:
<BLOCKQUOTE><CODE>
<PRE>
$ mythfilldatabase --import-icon-map iconmap.xml --update-icon-map
</PRE>
</CODE></BLOCKQUOTE>

<A NAME="manually_building_mythtv"></A> </P>
<H2><A NAME="ss5.5">5.5</A> <A HREF="mythtv-HOWTO.html#toc5.5">Manually building MythTV.</A>
</H2>

<P>Unpack MythTV
<BLOCKQUOTE><CODE>
<PRE>
$ tar -xjf mythtv-0.15.tar.bz2
$ cd mythtv-0.15
$ ./configure
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>On a single cpu machine, you would type the following to compile MythTV:
<BLOCKQUOTE><CODE>
<PRE>
$ qmake mythtv.pro
$ make
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>If you want to build MythTV on a multi-CPU machine (or with
<B>distcc</B>), you may run into issues with the standard build in MythTV.
The easiest solution is to build the libraries first.  In the following
example, we will have two concurrent jobs executing.  Do not set the number
of jobs too high, or your compile will actually take longer to complete than
it would if you did a "normal" build.
<BLOCKQUOTE><CODE>
<PRE>
$ qmake mythtv.pro
$ make qmake
$ make -C libs/libavcodec -j2
$ make -C libs/libavformat -j2
$ make -C libs/libmyth -j2 
$ make -C libs/libmythtv -j2
$ make -C libs -j2
$ make -j2
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>If you are using <B>distcc</B>, and you had two other host machines (red, blue)
participating, you would do something like:
<BLOCKQUOTE><CODE>
<PRE>
$ export DISTCC_HOSTS='localhost red blue'
$ qmake mythtv.pro
$ make qmake
$ make -C libs/libavcodec -j6 CC=distcc
$ make -C libs/libavformat -j6 CC=distcc
$ make -C libs/libmyth -j6 CXX=distcc
$ make -C libs/libmythtv -j6 CXX=distcc
$ make -C libs -j6 CXX=distcc
$ make -j6 CXX=distcc
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>Explicitly specifying the directories ensures that <B>make</B> has all
dependencies satisfied before proceeding.  For example, <CODE>libmyth</CODE> may
fail to compile if <CODE>libavformat</CODE> hasn't finished yet.</P>
<P>The actual speed-up, if any, is dependant on a number of factors, such as
number of CPUs / hosts, etc.  The <B>distcc</B> documentation recommends
using a <CODE>-j</CODE> value of twice the number of CPUs available to keep all
of them busy.</P>
<P>Some timing information.  The following should only be used for
illustration; your actual results may vary.  The test involves a complete
<CODE>make distclean</CODE> to the final binary.
<UL>
<LI>Celeron 2.4Ghz and PIII/733 running distcc, -j4:  17m:57s</LI>
<LI>Celeron 2.4Ghz, -j4:  26m:57s</LI>
<LI>Celeron 2.4Ghz, "regular" make:  26m:55s</LI>
</UL>
</P>
<P>In the above example, we see that with a single CPU, a multi-stage
<B>make</B> does not decrease compile time.</P>
<P>Once the compile is done, switch to superuser:
<BLOCKQUOTE><CODE>
<PRE>
$ su
# make install
# exit
</PRE>
</CODE></BLOCKQUOTE>
</P>
<P>
<FIGURE>
<EPS FILE="stop.eps">
<IMG SRC="stop.png">
<CAPTION><B>NOTE</B>:  subsequent configuration steps assume that you are within
the MythTV directory that you <CODE>cd</CODE>'d to above.</CAPTION>
</FIGURE>
</P>
<H3><A NAME="frontend-only"></A> Frontend-only configuration </H3>

<P>Since MythTV uses a client/server architecture, multiple frontend
computers can simultaneously access content on a Myth system.  Live TV,
watching and scheduling recordings, etc. are all possible from multiple
frontends.</P>
<P>To get a better picture of what is needed to run a frontend, note the
following:
<LI>You do NOT need the MySQL server installed on your remote frontend</LI>
<LI>You do NOT need XMLTV installed on your remote frontend</LI>
<LI>You do NOT need to run the MythTV setup program on
your frontend machine</LI>
</P>
<P>Other than the exclusion of the MySQL server and XMLTV, the MythTV
compilation procedure is the same as when you're setting up both a backend
and a frontend.  However, you <EM>will</EM> need to install the database
access libraries.</P>
<P>Once MythTV is compiled and installed, you must change your
<CODE>/usr/local/share/mythtv/mysql.txt</CODE> or <CODE>~/.mythtv/mysql.txt</CODE>
file's "DBHostName" field to point to your Master backend's IP address.</P>
<P>Run the MythTV setup program on your Master backend. Under the "General"
menu, change the IP address of the current machine (by default, "127.0.0.1")
to the real external IP address - 127.0.0.1 is the loopback address and no
external machine can access it. Change the Master Server IP setting to the
same IP address as well.</P>

<H2><A NAME="Gentoo_build"></A> <A NAME="ss5.6">5.6</A> <A HREF="mythtv-HOWTO.html#toc5.6">Gentoo. </A>
</H2>

<P>Installation of MythTV on Gentoo consists of simply emerging the desired
ebuild because all of the packages are now part of the official Portage tree.
<BLOCKQUOTE><CODE>
<PRE>
$ su -
# emerge --sync # make sure portage is up to date.
# vi /etc/make.conf
</PRE>
</CODE></BLOCKQUOTE>

Add mysql to your USE variable.  i.e. <CODE>USE="mysql ...."</CODE>
<BLOCKQUOTE><CODE>
<PRE>
# emerge mythtv
</PRE>
</CODE></BLOCKQUOTE>
</P>
<HR>
<A HREF="mythtv-HOWTO-6.html">Next</A>
<A HREF="mythtv-HOWTO-4.html">Previous</A>
<A HREF="mythtv-HOWTO.html#toc5">Contents</A>
</BODY>
</HTML>
